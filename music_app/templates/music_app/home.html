{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div class="album-list">
  {% for album in albums %}
    {% with album.title|cut:" " as clean_title %}
    <div class="album-card" id="album-card-{{ forloop.counter0 }}" onclick="toggleAlbum({{ forloop.counter0 }})">
      <div class="album-collapsed">
        <img src="{% static 'music_app/images/' %}{{ clean_title }}.jpg" alt="{{ album.title }} cover" class="album-cover-thumb">
        <div class="album-text">
          <h2>{{ album.title }}</h2>
          <p>{{ album.artist }}</p>
        </div>
      </div>

      <div id="album-details-{{ forloop.counter0 }}" class="album-expanded hidden">
        <img src="{% static 'music_app/images/' %}{{ clean_title }}.jpg" alt="{{ album.title }} large cover" class="album-cover-large">
        <div class="album-meta">
          <h2>{{ album.title }}</h2>
          <p class="album-artist">{{ album.artist }}</p>
          <p class="album-description">{{ album.description }}</p>
          <ul class="tracklist">
            {% for track in album.tracks|split_by_comma %}
              <li onclick="playTrack('{{ track }}', '{{ album.artist }}', '{% static 'music_app/records/' %}{{ track }}.mp3', '{% static 'music_app/images/' %}{{ clean_title }}.jpg')">
                <span class="track-title">{{ track }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
    {% endwith %}
  {% endfor %}
</div>

<div id="player" class="music-player hidden">
  <img id="player-cover" src="" class="player-cover" alt="cover">
  <div class="player-info">
    <h3 id="player-title">Title</h3>
    <p id="player-artist">Artist</p>
  </div>
  <audio id="audio" controls autoplay></audio>
  <button onclick="closePlayer()">Close</button>
</div>

<script src="{% static 'music_app/js/player.js' %}"></script>
<script src="{% static 'music_app/js/expand.js' %}"></script>
{% endblock %}








